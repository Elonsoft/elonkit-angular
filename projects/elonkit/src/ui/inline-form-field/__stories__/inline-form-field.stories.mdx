import { Meta, Story, Props } from '@storybook/addon-docs/blocks';
import { Preview } from '~storybook/components';

import { withA11y } from '@storybook/addon-a11y';
import { action } from '@storybook/addon-actions';
import { withKnobs, text } from '@storybook/addon-knobs';

import { BrowserAnimationsModule } from '@angular/platform-browser/animations';

import { ESInlineFormFieldComponent } from '..';

import {
  InlineFormFieldStoryBasicModule,
  InlineFormFieldStoryBasicComponent,
  INLINE_FORM_FIELD_STORY_BASIC_SOURCE
} from './inline-form-field-story-basic';

import {
  InlineFormFieldStoryTypographyModule,
  InlineFormFieldStoryTypographyComponent,
  INLINE_FORM_FIELD_STORY_TYPOGRAPHY_SOURCE
} from './inline-form-field-story-typography';

import {
  InlineFormFieldStoryCompositionModule,
  InlineFormFieldStoryCompositionComponent,
  INLINE_FORM_FIELD_STORY_COMPOSITION_SOURCE
} from './inline-form-field-story-composition';

import {
  InlineFormFieldStoryCancelModule,
  InlineFormFieldStoryCancelComponent,
  INLINE_FORM_FIELD_STORY_CANCEL_SOURCE
} from './inline-form-field-story-cancel';

import {
  InlineFormFieldStoryLocaleModule,
  InlineFormFieldStoryLocaleComponent,
  INLINE_FORM_FIELD_STORY_LOCALE_SOURCE
} from './inline-form-field-story-locale';

import {
  InlineFormFieldStoryValidationModule,
  InlineFormFieldStoryValidationComponent,
  INLINE_FORM_FIELD_STORY_VALIDATION_SOURCE
} from './inline-form-field-story-validation';

<Meta title='UI/Inline Form Field' decorators={[withA11y, withKnobs]} />

# Inline Form Field

This component allows inline switching between display value and input.

## Demos

<Preview source={INLINE_FORM_FIELD_STORY_BASIC_SOURCE}>
  <Story name='Basic' height='50px'>
    {{
      component: InlineFormFieldStoryBasicComponent,
      moduleMetadata: {
        imports: [BrowserAnimationsModule, InlineFormFieldStoryBasicModule]
      }
    }}
  </Story>
</Preview>

We can use `typography` input in order to change text presentation.

<Preview source={INLINE_FORM_FIELD_STORY_TYPOGRAPHY_SOURCE}>
  <Story name='Typography' height='170px'>
    {{
      component: InlineFormFieldStoryTypographyComponent,
      moduleMetadata: {
        imports: [BrowserAnimationsModule, InlineFormFieldStoryTypographyModule]
      },
      props: {
        typography: text('typography', 'mat-h2')
      }
    }}
  </Story>
</Preview>

This component is compatible with any\* Angular Material form field feature.

<Preview source={INLINE_FORM_FIELD_STORY_COMPOSITION_SOURCE}>
  <Story name='Composition' height='380px'>
    {{
      component: InlineFormFieldStoryCompositionComponent,
      moduleMetadata: {
        imports: [BrowserAnimationsModule, InlineFormFieldStoryCompositionModule]
      }
    }}
  </Story>
</Preview>

With help of `edit` and `cancel` outputs we can restore previous input value.

<Preview source={INLINE_FORM_FIELD_STORY_CANCEL_SOURCE}>
  <Story name='Cancel' height='50px'>
    {{
      component: InlineFormFieldStoryCancelComponent,
      moduleMetadata: {
        imports: [BrowserAnimationsModule, InlineFormFieldStoryCancelModule]
      }
    }}
  </Story>
</Preview>

We can override default locale which is used for `aria-label`'s on buttons.

<Preview source={INLINE_FORM_FIELD_STORY_LOCALE_SOURCE}>
  <Story name='Locale' height='50px'>
    {{
      component: InlineFormFieldStoryLocaleComponent,
      moduleMetadata: {
        imports: [BrowserAnimationsModule, InlineFormFieldStoryLocaleModule]
      }
    }}
  </Story>
</Preview>

Synchronous validations for template-driven and reactive forms are supported out of the box.
If there are any server-side validations you should take advantage of `manualSave` input.

<Preview source={INLINE_FORM_FIELD_STORY_VALIDATION_SOURCE}>
  <Story name='Validation' height='100px'>
    {{
      component: InlineFormFieldStoryValidationComponent,
      moduleMetadata: {
        imports: [BrowserAnimationsModule, InlineFormFieldStoryValidationModule]
      }
    }}
  </Story>
</Preview>

## API

<Props of={ESInlineFormFieldComponent} />

## Constants

Injection token that can be used to configure the default options for all components within an app.

```ts
import { ES_INLINE_FORM_FIELD_DEFAULT_OPTIONS } from '@elonsoft/elonkit/ui/inline-form-field';

@NgModule({
  providers: [
    {
      provide: ES_INLINE_FORM_FIELD_DEFAULT_OPTIONS,
      useValue: {
        typography: 'mat-body-1'
      }
    }
  ]
})
```
